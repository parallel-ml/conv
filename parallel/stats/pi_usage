+++++++++++++++++++++++++++++++++++++++++++++++++++++++
running network:  resnet
load model: 529.26s
inference: 3.99s
Filename: keras_quick_start.py

Line #    Mem usage    Increment   Line Contents
================================================
    61    135.9 MiB      0.0 MiB   @profile
    62                             def run_network(ntype):
    63    135.9 MiB      0.0 MiB       log(ntype)
    64    135.9 MiB      0.0 MiB       timestamp()
    65                                 # keras provides API for directly geting a 50-layer res-net model with imagenet weight
    66    306.2 MiB    170.3 MiB       with Network(ntype) as NN:
    67    306.2 MiB      0.0 MiB           timestamp('load model')
    68                                     # the input passed into keras forwarding function is expected to be 4D
    69                                     # the image is 3D and the input is a list of different images
    70    306.2 MiB      0.0 MiB           test_x = np.array([resized_image])
    71                                     # output probability of being in each of 1000 classes
    72    306.2 MiB      0.0 MiB           timestamp()
    73    310.9 MiB      4.6 MiB           NN.predict(test_x)
    74    209.8 MiB   -101.0 MiB           timestamp('inference')


+++++++++++++++++++++++++++++++++++++++++++++++++++++++
running network:  mobilenet
Downloading data from https://github.com/fchollet/deep-learning-models/releases/download/v0.6/mobilenet_1_0_224_tf.h5
   16384/17225924 [..............................] - ETA: 1s   40960/17225924 [..............................] - ETA: 38s   57344/17225924 [..............................] - ETA: 48s   73728/17225924 [..............................] - ETA: 52s  106496/17225924 [..............................] - ETA: 59s  122880/17225924 [..............................] - ETA: 62s  163840/17225924 [..............................] - ETA: 52s  188416/17225924 [..............................] - ETA: 50s  196608/17225924 [..............................] - ETA: 58s  212992/17225924 [..............................] - ETA: 59s  245760/17225924 [..............................] - ETA: 57s  262144/17225924 [..............................] - ETA: 57s  278528/17225924 [..............................] - ETA: 57s  319488/17225924 [..............................] - ETA: 55s  335872/17225924 [..............................] - ETA: 58s  368640/17225924 [..............................] - ETA: 58s  417792/17225924 [..............................] - ETA: 54s  442368/17225924 [..............................] - ETA: 53s  458752/17225924 [..............................] - ETA: 53s  491520/17225924 [..............................] - ETA: 51s  507904/17225924 [..............................] - ETA: 52s  540672/17225924 [..............................] - ETA: 51s  573440/17225924 [..............................] - ETA: 50s  598016/17225924 [>.............................] - ETA: 49s  614400/17225924 [>.............................] - ETA: 50s  647168/17225924 [>.............................] - ETA: 49s  696320/17225924 [>.............................] - ETA: 48s  720896/17225924 [>.............................] - ETA: 47s  737280/17225924 [>.............................] - ETA: 48s  770048/17225924 [>.............................] - ETA: 47s  802816/17225924 [>.............................] - ETA: 46s  819200/17225924 [>.............................] - ETA: 47s  860160/17225924 [>.............................] - ETA: 46s  909312/17225924 [>.............................] - ETA: 45s  942080/17225924 [>.............................] - ETA: 45s  958464/17225924 [>.............................] - ETA: 45s  999424/17225924 [>.............................] - ETA: 44s 1015808/17225924 [>.............................] - ETA: 44s 1064960/17225924 [>.............................] - ETA: 44s 1097728/17225924 [>.............................] - ETA: 44s 1114112/17225924 [>.............................] - ETA: 44s 1138688/17225924 [>.............................] - ETA: 43s 1171456/17225924 [=>............................] - ETA: 43s 1204224/17225924 [=>............................] - ETA: 44s 1236992/17225924 [=>............................] - ETA: 43s 1277952/17225924 [=>............................] - ETA: 43s 1310720/17225924 [=>............................] - ETA: 44s 1343488/17225924 [=>............................] - ETA: 43s 1359872/17225924 [=>............................] - ETA: 44s 1392640/17225924 [=>............................] - ETA: 43s 1433600/17225924 [=>............................] - ETA: 43s 1449984/17225924 [=>............................] - ETA: 44s 1482752/17225924 [=>............................] - ETA: 43s 1515520/17225924 [=>............................] - ETA: 43s 1572864/17225924 [=>............................] - ETA: 42s 1605632/17225924 [=>............................] - ETA: 42s 1638400/17225924 [=>............................] - ETA: 42s 1654784/17225924 [=>............................] - ETA: 42s 1712128/17225924 [=>............................] - ETA: 41s 1744896/17225924 [==>...........................] - ETA: 41s 1777664/17225924 [==>...........................] - ETA: 41s 1794048/17225924 [==>...........................] - ETA: 41s 1835008/17225924 [==>...........................] - ETA: 40s 1867776/17225924 [==>...........................] - ETA: 40s 1900544/17225924 [==>...........................] - ETA: 40s 1933312/17225924 [==>...........................] - ETA: 40s 1949696/17225924 [==>...........................] - ETA: 40s 1990656/17225924 [==>...........................] - ETA: 40s 2007040/17225924 [==>...........................] - ETA: 40s 2039808/17225924 [==>...........................] - ETA: 39s 2088960/17225924 [==>...........................] - ETA: 39s 2113536/17225924 [==>...........................] - ETA: 39s 2162688/17225924 [==>...........................] - ETA: 38s 2195456/17225924 [==>...........................] - ETA: 38s 2228224/17225924 [==>...........................] - ETA: 38s 2285568/17225924 [==>...........................] - ETA: 37s 2334720/17225924 [===>..........................] - ETA: 37s 2392064/17225924 [===>..........................] - ETA: 37s 2424832/17225924 [===>..........................] - ETA: 37s 2441216/17225924 [===>..........................] - ETA: 37s 2473984/17225924 [===>..........................] - ETA: 37s 2490368/17225924 [===>..........................] - ETA: 37s 2531328/17225924 [===>..........................] - ETA: 37s 2564096/17225924 [===>..........................] - ETA: 36s 2580480/17225924 [===>..........................] - ETA: 36s 2613248/17225924 [===>..........................] - ETA: 36s 2646016/17225924 [===>..........................] - ETA: 36s 2686976/17225924 [===>..........................] - ETA: 36s 2736128/17225924 [===>..........................] - ETA: 36s 2777088/17225924 [===>..........................] - ETA: 35s 2809856/17225924 [===>..........................] - ETA: 35s 2842624/17225924 [===>..........................] - ETA: 35s 2875392/17225924 [====>.........................] - ETA: 35s 2908160/17225924 [====>.........................] - ETA: 34s 2924544/17225924 [====>.........................] - ETA: 35s 2981888/17225924 [====>.........................] - ETA: 34s 2998272/17225924 [====>.........................] - ETA: 34s 3047424/17225924 [====>.........................] - ETA: 34s 3063808/17225924 [====>.........................] - ETA: 34s 3121152/17225924 [====>.........................] - ETA: 34s 3137536/17225924 [====>.........................] - ETA: 34s 3170304/17225924 [====>.........................] - ETA: 33s 3203072/17225924 [====>.........................] - ETA: 33s 3235840/17225924 [====>.........................] - ETA: 33s 3268608/17225924 [====>.........................] - ETA: 33s 3293184/17225924 [====>.........................] - ETA: 33s 3325952/17225924 [====>.........................] - ETA: 33s 3383296/17225924 [====>.........................] - ETA: 32s 3416064/17225924 [====>.........................] - ETA: 32s 3457024/17225924 [=====>........................] - ETA: 32s 3506176/17225924 [=====>........................] - ETA: 32s 3555328/17225924 [=====>........................] - ETA: 31s 3604480/17225924 [=====>........................] - ETA: 31s 3661824/17225924 [=====>........................] - ETA: 31s 3694592/17225924 [=====>........................] - ETA: 31s 3727360/17225924 [=====>........................] - ETA: 31s 3751936/17225924 [=====>........................] - ETA: 31s 3801088/17225924 [=====>........................] - ETA: 31s 3850240/17225924 [=====>........................] - ETA: 30s 3866624/17225924 [=====>........................] - ETA: 30s 3899392/17225924 [=====>........................] - ETA: 30s 3940352/17225924 [=====>........................] - ETA: 30s 3973120/17225924 [=====>........................] - ETA: 30s 4022272/17225924 [======>.......................] - ETA: 30s 4063232/17225924 [======>.......................] - ETA: 30s 4112384/17225924 [======>.......................] - ETA: 29s 4145152/17225924 [======>.......................] - ETA: 29s 4202496/17225924 [======>.......................] - ETA: 29s 4218880/17225924 [======>.......................] - ETA: 29s 4251648/17225924 [======>.......................] - ETA: 29s 4268032/17225924 [======>.......................] - ETA: 29s 4292608/17225924 [======>.......................] - ETA: 29s 4325376/17225924 [======>.......................] - ETA: 29s 4358144/17225924 [======>.......................] - ETA: 28s 4390912/17225924 [======>.......................] - ETA: 28s 4423680/17225924 [======>.......................] - ETA: 28s 4440064/17225924 [======>.......................] - ETA: 28s 4481024/17225924 [======>.......................] - ETA: 28s 4521984/17225924 [======>.......................] - ETA: 28s 4546560/17225924 [======>.......................] - ETA: 28s 4595712/17225924 [=======>......................] - ETA: 28s 4636672/17225924 [=======>......................] - ETA: 28s 4702208/17225924 [=======>......................] - ETA: 27s 4751360/17225924 [=======>......................] - ETA: 27s 4775936/17225924 [=======>......................] - ETA: 27s 4808704/17225924 [=======>......................] - ETA: 27s 4857856/17225924 [=======>......................] - ETA: 27s 4915200/17225924 [=======>......................] - ETA: 27s 4931584/17225924 [=======>......................] - ETA: 27s 4980736/17225924 [=======>......................] - ETA: 26s 5038080/17225924 [=======>......................] - ETA: 26s 5054464/17225924 [=======>......................] - ETA: 26s 5103616/17225924 [=======>......................] - ETA: 26s 5136384/17225924 [=======>......................] - ETA: 26s 5177344/17225924 [========>.....................] - ETA: 26s 5226496/17225924 [========>.....................] - ETA: 26s 5259264/17225924 [========>.....................] - ETA: 25s 5292032/17225924 [========>.....................] - ETA: 25s 5332992/17225924 [========>.....................] - ETA: 25s 5365760/17225924 [========>.....................] - ETA: 25s 5398528/17225924 [========>.....................] - ETA: 25s 5472256/17225924 [========>.....................] - ETA: 25s 5505024/17225924 [========>.....................] - ETA: 25s 5545984/17225924 [========>.....................] - ETA: 25s 5570560/17225924 [========>.....................] - ETA: 25s 5611520/17225924 [========>.....................] - ETA: 25s 5627904/17225924 [========>.....................] - ETA: 25s 5660672/17225924 [========>.....................] - ETA: 25s 5709824/17225924 [========>.....................] - ETA: 24s 5750784/17225924 [=========>....................] - ETA: 24s 5783552/17225924 [=========>....................] - ETA: 24s 5816320/17225924 [=========>....................] - ETA: 24s 5849088/17225924 [=========>....................] - ETA: 24s 5873664/17225924 [=========>....................] - ETA: 24s 5890048/17225924 [=========>....................] - ETA: 24s 5914624/17225924 [=========>....................] - ETA: 24s 5939200/17225924 [=========>....................] - ETA: 24s 5955584/17225924 [=========>....................] - ETA: 24s 5988352/17225924 [=========>....................] - ETA: 24s 6012928/17225924 [=========>....................] - ETA: 24s 6045696/17225924 [=========>....................] - ETA: 24s 6078464/17225924 [=========>....................] - ETA: 24s 6111232/17225924 [=========>....................] - ETA: 24s 6152192/17225924 [=========>....................] - ETA: 24s 6184960/17225924 [=========>....................] - ETA: 24s 6234112/17225924 [=========>....................] - ETA: 24s 6266880/17225924 [=========>....................] - ETA: 24s 6307840/17225924 [=========>....................] - ETA: 24s 6340608/17225924 [==========>...................] - ETA: 24s 6381568/17225924 [==========>...................] - ETA: 23s 6430720/17225924 [==========>...................] - ETA: 23s 6479872/17225924 [==========>...................] - ETA: 23s 6512640/17225924 [==========>...................] - ETA: 23s 6545408/17225924 [==========>...................] - ETA: 23s 6586368/17225924 [==========>...................] - ETA: 23s 6635520/17225924 [==========>...................] - ETA: 23s 6660096/17225924 [==========>...................] - ETA: 23s 6684672/17225924 [==========>...................] - ETA: 22s 6709248/17225924 [==========>...................] - ETA: 22s 6742016/17225924 [==========>...................] - ETA: 22s 6774784/17225924 [==========>...................] - ETA: 22s 6807552/17225924 [==========>...................] - ETA: 22s 6848512/17225924 [==========>...................] - ETA: 22s 6864896/17225924 [==========>...................] - ETA: 22s 6914048/17225924 [===========>..................] - ETA: 22s 6963200/17225924 [===========>..................] - ETA: 22s 7020544/17225924 [===========>..................] - ETA: 22s 7053312/17225924 [===========>..................] - ETA: 22s 7069696/17225924 [===========>..................] - ETA: 22s 7127040/17225924 [===========>..................] - ETA: 22s 7159808/17225924 [===========>..................] - ETA: 21s 7192576/17225924 [===========>..................] - ETA: 21s 7225344/17225924 [===========>..................] - ETA: 21s 7266304/17225924 [===========>..................] - ETA: 21s 7299072/17225924 [===========>..................] - ETA: 21s 7364608/17225924 [===========>..................] - ETA: 21s 7405568/17225924 [===========>..................] - ETA: 21s 7446528/17225924 [===========>..................] - ETA: 21s 7487488/17225924 [============>.................] - ETA: 21s 7503872/17225924 [============>.................] - ETA: 21s 7544832/17225924 [============>.................] - ETA: 21s 7577600/17225924 [============>.................] - ETA: 20s 7610368/17225924 [============>.................] - ETA: 20s 7626752/17225924 [============>.................] - ETA: 20s 7659520/17225924 [============>.................] - ETA: 20s 7708672/17225924 [============>.................] - ETA: 20s 7749632/17225924 [============>.................] - ETA: 20s 7782400/17225924 [============>.................] - ETA: 20s 7815168/17225924 [============>.................] - ETA: 20s 7856128/17225924 [============>.................] - ETA: 20s 7888896/17225924 [============>.................] - ETA: 20s 7938048/17225924 [============>.................] - ETA: 20s 7995392/17225924 [============>.................] - ETA: 19s 8028160/17225924 [============>.................] - ETA: 19s 8044544/17225924 [=============>................] - ETA: 19s 8101888/17225924 [=============>................] - ETA: 19s 8134656/17225924 [=============>................] - ETA: 19s 8183808/17225924 [=============>................] - ETA: 19s 8216576/17225924 [=============>................] - ETA: 19s 8273920/17225924 [=============>................] - ETA: 19s 8323072/17225924 [=============>................] - ETA: 19s 8355840/17225924 [=============>................] - ETA: 19s 8413184/17225924 [=============>................] - ETA: 18s 8429568/17225924 [=============>................] - ETA: 18s 8462336/17225924 [=============>................] - ETA: 18s 8503296/17225924 [=============>................] - ETA: 18s 8536064/17225924 [=============>................] - ETA: 18s 8552448/17225924 [=============>................] - ETA: 18s 8568832/17225924 [=============>................] - ETA: 18s 8601600/17225924 [=============>................] - ETA: 18s 8634368/17225924 [==============>...............] - ETA: 18s 8683520/17225924 [==============>...............] - ETA: 18s 8708096/17225924 [==============>...............] - ETA: 18s 8740864/17225924 [==============>...............] - ETA: 18s 8757248/17225924 [==============>...............] - ETA: 18s 8814592/17225924 [==============>...............] - ETA: 18s 8830976/17225924 [==============>...............] - ETA: 18s 8863744/17225924 [==============>...............] - ETA: 18s 8896512/17225924 [==============>...............] - ETA: 18s 9109504/17225924 [==============>...............] - ETA: 17s 9158656/17225924 [==============>...............] - ETA: 17s 9175040/17225924 [==============>...............] - ETA: 17s 9216000/17225924 [===============>..............] - ETA: 17s 9232384/17225924 [===============>..............] - ETA: 17s 9265152/17225924 [===============>..............] - ETA: 17s 9297920/17225924 [===============>..............] - ETA: 17s 9330688/17225924 [===============>..............] - ETA: 17s 9371648/17225924 [===============>..............] - ETA: 17s 9404416/17225924 [===============>..............] - ETA: 17s 9420800/17225924 [===============>..............] - ETA: 17s 9453568/17225924 [===============>..............] - ETA: 16s 9469952/17225924 [===============>..............] - ETA: 16s 9510912/17225924 [===============>..............] - ETA: 16s 9527296/17225924 [===============>..............] - ETA: 16s 9560064/17225924 [===============>..............] - ETA: 16s 9592832/17225924 [===============>..............] - ETA: 16s 9633792/17225924 [===============>..............] - ETA: 16s 9666560/17225924 [===============>..............] - ETA: 16s 9707520/17225924 [===============>..............] - ETA: 16s 9732096/17225924 [===============>..............] - ETA: 16s 9781248/17225924 [================>.............] - ETA: 16s 9789440/17225924 [================>.............] - ETA: 16s 9805824/17225924 [================>.............] - ETA: 16s 9854976/17225924 [================>.............] - ETA: 16s 9912320/17225924 [================>.............] - ETA: 16s 9945088/17225924 [================>.............] - ETA: 15s 9961472/17225924 [================>.............] - ETA: 15s 9994240/17225924 [================>.............] - ETA: 15s10027008/17225924 [================>.............] - ETA: 15s10084352/17225924 [================>.............] - ETA: 15s10133504/17225924 [================>.............] - ETA: 15s10166272/17225924 [================>.............] - ETA: 15s10223616/17225924 [================>.............] - ETA: 15s10256384/17225924 [================>.............] - ETA: 15s10272768/17225924 [================>.............] - ETA: 15s10289152/17225924 [================>.............] - ETA: 15s10330112/17225924 [================>.............] - ETA: 15s10362880/17225924 [=================>............] - ETA: 15s10395648/17225924 [=================>............] - ETA: 14s10428416/17225924 [=================>............] - ETA: 14s10469376/17225924 [=================>............] - ETA: 14s10502144/17225924 [=================>............] - ETA: 14s10534912/17225924 [=================>............] - ETA: 14s10584064/17225924 [=================>............] - ETA: 14s10625024/17225924 [=================>............] - ETA: 14s10657792/17225924 [=================>............] - ETA: 14s10690560/17225924 [=================>............] - ETA: 14s10723328/17225924 [=================>............] - ETA: 14s10747904/17225924 [=================>............] - ETA: 14s10797056/17225924 [=================>............] - ETA: 13s10846208/17225924 [=================>............] - ETA: 13s10887168/17225924 [=================>............] - ETA: 13s10919936/17225924 [==================>...........] - ETA: 13s10952704/17225924 [==================>...........] - ETA: 13s11206656/17225924 [==================>...........] - ETA: 13s11247616/17225924 [==================>...........] - ETA: 13s11321344/17225924 [==================>...........] - ETA: 12s11337728/17225924 [==================>...........] - ETA: 12s11354112/17225924 [==================>...........] - ETA: 12s11386880/17225924 [==================>...........] - ETA: 12s11419648/17225924 [==================>...........] - ETA: 12s11460608/17225924 [==================>...........] - ETA: 12s11476992/17225924 [==================>...........] - ETA: 12s11526144/17225924 [===================>..........] - ETA: 12s11542528/17225924 [===================>..........] - ETA: 12s11558912/17225924 [===================>..........] - ETA: 12s11599872/17225924 [===================>..........] - ETA: 12s11632640/17225924 [===================>..........] - ETA: 12s11681792/17225924 [===================>..........] - ETA: 12s11739136/17225924 [===================>..........] - ETA: 12s11771904/17225924 [===================>..........] - ETA: 12s11788288/17225924 [===================>..........] - ETA: 12s11837440/17225924 [===================>..........] - ETA: 11s11862016/17225924 [===================>..........] - ETA: 11s11894784/17225924 [===================>..........] - ETA: 11s11927552/17225924 [===================>..........] - ETA: 11s11976704/17225924 [===================>..........] - ETA: 11s12017664/17225924 [===================>..........] - ETA: 11s12042240/17225924 [===================>..........] - ETA: 11s12083200/17225924 [====================>.........] - ETA: 11s12115968/17225924 [====================>.........] - ETA: 11s12173312/17225924 [====================>.........] - ETA: 11s12206080/17225924 [====================>.........] - ETA: 11s12238848/17225924 [====================>.........] - ETA: 11s12296192/17225924 [====================>.........] - ETA: 10s12328960/17225924 [====================>.........] - ETA: 10s12378112/17225924 [====================>.........] - ETA: 10s12435456/17225924 [====================>.........] - ETA: 10s12484608/17225924 [====================>.........] - ETA: 10s12500992/17225924 [====================>.........] - ETA: 10s12533760/17225924 [====================>.........] - ETA: 10s12591104/17225924 [====================>.........] - ETA: 10s12640256/17225924 [=====================>........] - ETA: 10s12697600/17225924 [=====================>........] - ETA: 9s 12713984/17225924 [=====================>........] - ETA: 9s12746752/17225924 [=====================>........] - ETA: 9s12779520/17225924 [=====================>........] - ETA: 9s12820480/17225924 [=====================>........] - ETA: 9s12869632/17225924 [=====================>........] - ETA: 9s12918784/17225924 [=====================>........] - ETA: 9s12976128/17225924 [=====================>........] - ETA: 9s13025280/17225924 [=====================>........] - ETA: 9s13041664/17225924 [=====================>........] - ETA: 9s13123584/17225924 [=====================>........] - ETA: 9s13320192/17225924 [======================>.......] - ETA: 8s13352960/17225924 [======================>.......] - ETA: 8s13369344/17225924 [======================>.......] - ETA: 8s13393920/17225924 [======================>.......] - ETA: 8s13410304/17225924 [======================>.......] - ETA: 8s13443072/17225924 [======================>.......] - ETA: 8s13508608/17225924 [======================>.......] - ETA: 8s13549568/17225924 [======================>.......] - ETA: 7s13582336/17225924 [======================>.......] - ETA: 7s13615104/17225924 [======================>.......] - ETA: 7s13647872/17225924 [======================>.......] - ETA: 7s13705216/17225924 [======================>.......] - ETA: 7s13721600/17225924 [======================>.......] - ETA: 7s13746176/17225924 [======================>.......] - ETA: 7s13770752/17225924 [======================>.......] - ETA: 7s13811712/17225924 [=======================>......] - ETA: 7s13844480/17225924 [=======================>......] - ETA: 7s13893632/17225924 [=======================>......] - ETA: 7s13926400/17225924 [=======================>......] - ETA: 7s13967360/17225924 [=======================>......] - ETA: 7s14000128/17225924 [=======================>......] - ETA: 6s14032896/17225924 [=======================>......] - ETA: 6s14065664/17225924 [=======================>......] - ETA: 6s14090240/17225924 [=======================>......] - ETA: 6s14139392/17225924 [=======================>......] - ETA: 6s14172160/17225924 [=======================>......] - ETA: 6s14204928/17225924 [=======================>......] - ETA: 6s14245888/17225924 [=======================>......] - ETA: 6s14278656/17225924 [=======================>......] - ETA: 6s14327808/17225924 [=======================>......] - ETA: 6s14368768/17225924 [========================>.....] - ETA: 6s14417920/17225924 [========================>.....] - ETA: 6s14450688/17225924 [========================>.....] - ETA: 5s14508032/17225924 [========================>.....] - ETA: 5s14548992/17225924 [========================>.....] - ETA: 5s14589952/17225924 [========================>.....] - ETA: 5s14647296/17225924 [========================>.....] - ETA: 5s14663680/17225924 [========================>.....] - ETA: 5s14696448/17225924 [========================>.....] - ETA: 5s14729216/17225924 [========================>.....] - ETA: 5s14745600/17225924 [========================>.....] - ETA: 5s14786560/17225924 [========================>.....] - ETA: 5s14819328/17225924 [========================>.....] - ETA: 5s14852096/17225924 [========================>.....] - ETA: 5s14901248/17225924 [========================>.....] - ETA: 4s14942208/17225924 [=========================>....] - ETA: 4s14974976/17225924 [=========================>....] - ETA: 4s15007744/17225924 [=========================>....] - ETA: 4s15040512/17225924 [=========================>....] - ETA: 4s15114240/17225924 [=========================>....] - ETA: 4s15138816/17225924 [=========================>....] - ETA: 4s15163392/17225924 [=========================>....] - ETA: 4s15220736/17225924 [=========================>....] - ETA: 4s15253504/17225924 [=========================>....] - ETA: 4s15286272/17225924 [=========================>....] - ETA: 4s15319040/17225924 [=========================>....] - ETA: 4s15360000/17225924 [=========================>....] - ETA: 3s15417344/17225924 [=========================>....] - ETA: 3s15425536/17225924 [=========================>....] - ETA: 3s15482880/17225924 [=========================>....] - ETA: 3s15499264/17225924 [=========================>....] - ETA: 3s15548416/17225924 [==========================>...] - ETA: 3s15581184/17225924 [==========================>...] - ETA: 3s15638528/17225924 [==========================>...] - ETA: 3s15671296/17225924 [==========================>...] - ETA: 3s15704064/17225924 [==========================>...] - ETA: 3s15761408/17225924 [==========================>...] - ETA: 3s15810560/17225924 [==========================>...] - ETA: 3s15859712/17225924 [==========================>...] - ETA: 2s15917056/17225924 [==========================>...] - ETA: 2s15949824/17225924 [==========================>...] - ETA: 2s15982592/17225924 [==========================>...] - ETA: 2s15998976/17225924 [==========================>...] - ETA: 2s16039936/17225924 [==========================>...] - ETA: 2s16072704/17225924 [==========================>...] - ETA: 2s16105472/17225924 [===========================>..] - ETA: 2s16138240/17225924 [===========================>..] - ETA: 2s16154624/17225924 [===========================>..] - ETA: 2s16211968/17225924 [===========================>..] - ETA: 2s16261120/17225924 [===========================>..] - ETA: 2s16293888/17225924 [===========================>..] - ETA: 1s16318464/17225924 [===========================>..] - ETA: 1s16351232/17225924 [===========================>..] - ETA: 1s16400384/17225924 [===========================>..] - ETA: 1s16433152/17225924 [===========================>..] - ETA: 1s16474112/17225924 [===========================>..] - ETA: 1s16539648/17225924 [===========================>..] - ETA: 1s16572416/17225924 [===========================>..] - ETA: 1s16629760/17225924 [===========================>..] - ETA: 1s16678912/17225924 [============================>.] - ETA: 1s16736256/17225924 [============================>.] - ETA: 1s16760832/17225924 [============================>.] - ETA: 0s16818176/17225924 [============================>.] - ETA: 0s16850944/17225924 [============================>.] - ETA: 0s16891904/17225924 [============================>.] - ETA: 0s16924672/17225924 [============================>.] - ETA: 0s16957440/17225924 [============================>.] - ETA: 0s17014784/17225924 [============================>.] - ETA: 0s17039360/17225924 [============================>.] - ETA: 0s17063936/17225924 [============================>.] - ETA: 0s17113088/17225924 [============================>.] - ETA: 0s17170432/17225924 [============================>.] - ETA: 0s17203200/17225924 [============================>.] - ETA: 0sload model: 299.98s
inference: 1.84s
Filename: keras_quick_start.py

Line #    Mem usage    Increment   Line Contents
================================================
    61    135.7 MiB      0.0 MiB   @profile
    62                             def run_network(ntype):
    63    135.7 MiB      0.0 MiB       log(ntype)
    64    135.7 MiB      0.0 MiB       timestamp()
    65                                 # keras provides API for directly geting a 50-layer res-net model with imagenet weight
    66    188.1 MiB     52.4 MiB       with Network(ntype) as NN:
    67    188.1 MiB      0.0 MiB           timestamp('load model')
    68                                     # the input passed into keras forwarding function is expected to be 4D
    69                                     # the image is 3D and the input is a list of different images
    70    188.1 MiB      0.0 MiB           test_x = np.array([resized_image])
    71                                     # output probability of being in each of 1000 classes
    72    188.1 MiB      0.0 MiB           timestamp()
    73    193.8 MiB      5.8 MiB           NN.predict(test_x)
    74    174.2 MiB    -19.6 MiB           timestamp('inference')


